from flask import Flask, request, make_response
import json

app = Flask(__name__)

FLAG = "KALAM25{C00KIE_H4CK3D_F0RU}"

@app.route("/")
def home():
    return '''
        <h2>Lets see who can eat more Cookies</h2>
        <button onclick="window.location.href='/check';">check that now </button>
    '''

@app.route("/")
def get_cookie():
    # Set a default cookie with role "user"
    resp = make_response("Cookie set! Now check your cookies.")
    resp.set_cookie("auth", json.dumps({"role": "user"}))  # Cookie is JSON encoded
    return resp

@app.route("/check")
def check_cookie():
    auth_cookie = request.cookies.get("auth", "{}")

    try:
        auth_data = json.loads(auth_cookie)  # Decode the JSON cookie
        if auth_data.get("role") == "admin":
            return f"Congratulations! : {FLAG}"
        else:
            return "‚ùå Access Denied! You need admin privileges."
    except:
        return "Invalid cookie format!"

if __name__ == "__main__":
    app.run(debug=True)

